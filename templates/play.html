<!DOCTYPE html>
<html>
<head>
  <title>Play Tic Tac Toe</title>
  <style>
    .board { display: grid; grid-template-columns: repeat(3, 100px); gap: 5px; }
    .cell { width: 100px; height: 100px; font-size: 2em; text-align: center; }
  </style>
  <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
</head>
<body>
  <h2>Tic Tac Toe</h2>
  <p id="turn">Turn: </p>

  <div class="board" id="board"></div>

  <script>
    const socket = io();
    let gameCode = null;

    // Render board
    function renderBoard(board, turn) {
      const boardDiv = document.getElementById("board");
      boardDiv.innerHTML = "";
      board.forEach((cell, i) => {
        const btn = document.createElement("button");
        btn.classList.add("cell");
        btn.innerText = cell || "-";
        btn.disabled = cell !== "";
        btn.onclick = () => {
          socket.emit("make_move", { code: gameCode, index: i });
        };
        boardDiv.appendChild(btn);
      });
      document.getElementById("turn").innerText = "Turn: " + turn;
    }

    socket.on("game_created", (data) => {
      gameCode = data.code;
      alert("Game created with code: " + gameCode);
    });

    socket.on("game_joined", (data) => {
      gameCode = data.code;
      alert("Joined game: " + gameCode);
    });

    socket.on("move_made", (data) => {
      renderBoard(data.board, data.turn);
    });

    function renderBoard(board, turn) {
    const boardDiv = document.getElementById("board");
    boardDiv.innerHTML = "";
    board.forEach((cell, i) => {
        const btn = document.createElement("button");
        btn.classList.add("cell");
        btn.innerText = cell || "-";
        btn.disabled = cell !== "";
        btn.onclick = () => socket.emit("make_move", { code: gameCode, index: i });
        boardDiv.appendChild(btn);
    });
    document.getElementById("turn").innerText = "Turn: " + turn;
}


socket.on("game_created", data => { gameCode = data.code; renderBoard(data.board, data.turn); });
socket.on("game_joined", data => { gameCode = data.code; renderBoard(data.board, data.turn); });
socket.on("move_made", data => renderBoard(data.board, data.turn));
socket.on("start_game", data => renderBoard(data.board, data.turn));

  </script>
</body>
</html>
